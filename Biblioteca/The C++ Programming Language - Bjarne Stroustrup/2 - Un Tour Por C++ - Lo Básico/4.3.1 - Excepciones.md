---
title: Excepciones
anterior: "[[Biblioteca/The C++ Programming Language - Bjarne Stroustrup/2 - Un Tour Por C++ - Lo Básico/4.3 - Manejo de errores]]"
siguiente: "[[Biblioteca/The C++ Programming Language - Bjarne Stroustrup/2 - Un Tour Por C++ - Lo Básico/4.3.2 - Invariantes]]"

---
Consideremos de nuevo el ejemplo de **Vector**.

¿Qué debería suceder cuando intentamos acceder a un elemento que está **fuera del rango** del vector?

- El **creador de Vector** no sabe qué le gustaría al usuario que ocurriera en ese caso (de hecho, normalmente ni siquiera sabe en qué programa específico se usará el vector).
- El **usuario de Vector** no puede detectar de manera consistente el problema (si pudiera, nunca ocurriría el acceso fuera de rango en primer lugar).

La solución es que el **implementador de Vector** detecte el intento de acceso fuera de rango y luego **notifique al usuario** sobre ello. De esta forma, el usuario puede tomar la acción adecuada.

Por ejemplo, `Vector::operator[]()` puede detectar el acceso fuera de rango y **lanzar una excepción** `out_of_range`:

```cpp
double& Vector::operator[](int i) {
    if (i < 0 || size() <= i)
        throw out_of_range{"Vector::operator[]"};
    return elem[i];
}
```

El `throw` transfiere el control a un **manejador de excepciones** del tipo `out_of_range` en alguna función que directa o indirectamente haya llamado a `Vector::operator[]()`.  
Para lograr esto, la implementación **desenrollará la pila de llamadas** hasta llegar al contexto del **llamador**.

Ejemplo:

```cpp
void f(Vector& v) {
    // ...
    try { // Excepciones aquí son manejadas por el catch definido abajo
        
        v[v.size()] = 7; // intentar acceder más allá del final de v
    }
    catch (out_of_range) { // ¡Ups!: error de fuera de rango
        // ... manejar error de rango ...
    }
    
    // ...
}
```

Ponemos el código para el cual nos interesa manejar excepciones dentro de un **bloque `try`**.  
Ese intento de asignación a `v[v.size()]` fallará. Por lo tanto, se ejecutará la cláusula `catch` que maneja `out_of_range`.

El tipo `out_of_range` está **definido en la biblioteca estándar**, y de hecho lo usan algunas funciones de acceso de los contenedores estándar.

El uso de **mecanismos de manejo de excepciones** puede hacer que el manejo de errores sea **más simple, sistemático y legible**.